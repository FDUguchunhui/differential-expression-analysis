intsc_124_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_2h', 'res_4h')], `[[`, 'gene_id')))
intsc_124_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_2h', 'res_4h')], `[[`, 'gene_id'))
length(intsc_124_up)
diff(intsc_124_up, row.names(res_6h))
diff(intsc_124_up, row.names(res_6h)
}
combn(c('1', '2', '4', '6'), m = 3)
combn(c('1', '2', '4', '6'), m = 2)
# use for intersection
res_list <- list(res_1h = res_1h, res_2h = res_2h, res_4h = res_4h, res_6h = res_6h)
res_list_down <- lapply(res_list, res_subgrodown, reg_dir ='down', alpha=1, reg_LFC=0)
res_list_down <- lapply(lapply(res_list_down, as_tibble, rownames = 'gene_id'),
dplyr::select, `gene_id`, `log2FoldChange`)
res_down_all <- Reduce(function(x, y) merge(x, y, by = 'gene_id',
all=TRUE, no.ddowns = T),
x = res_list_down)
Reduce(f = intersect, res_list_down)
#
res_list_all <- lapply(res_list, res_subgroup, reg_dir ='all', alpha=1, reg_LFC=0)
res_list_all <- lapply(lapply(res_list_all , as_tibble, rownames = 'gene_id'),
dplyr::select, `gene_id`, `log2FoldChange`)
res_all <- Reduce(function(x, y) merge(x, y, by = 'gene_id',
all=TRUE, no.dups = T),
x = res_list_all)
res_all
diff(intsc_124_up, row.names(res_6h)
diff(intsc_124_up, row.names(res_6h))
setdiff(intsc_124_up, row.names(res_6h))
row.names(res_6h)
intsc_124_up
row.names(res_6h)
setdiff(intsc_124_up, row.names(res_list_up_sig['res_6h']))
row.names(res_list_up_sig['res_6h'])
setdiff(intsc_124_up, row.names(res_list_up_sig['res_6h']))
intsc_124_up
row.names(res_list_up_sig['res_6h'])
row.names(res_list_up_sig['res_6h'])
res_list_up_sig['res_6h']
row.names(res_list_up_sig['res_6h'])
setdiff(intsc_124_up, res_list_up_sig['res_6h']$gene_id)
res_list_up_sig['res_6h']$gene_id
res_list_up_sig['res_6h']
res_list_up_sig['res_6h']$`gene_id`
res_list_up_sig['res_6h']
res_list_up_sig['res_6h']$log2FoldChange
a <- res_list_up_sig['res_6h']
setdiff(intsc_124_up, res_list_up_sig[['res_6h']]$log2FoldChange)
res_list_up_sig[['res_6h']]$log2FoldChange
setdiff(intsc_124_up, res_list_up_sig[['res_6h']]$gene_id)
combn(c('1', '2', '4', '6'), m = 3)
{
intsc_126_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_2h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_126_up)
setdiff(intsc_126_up, res_list_up_sig[['res_4h']]$gene_id)
}
{
intsc_146_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_126_up)
setdiff(intsc_126_up, res_list_up_sig[['res_2h']]$gene_id)
}
# 146 not 2
{
intsc_146_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_146_up)
setdiff(intsc_146_up, res_list_up_sig[['res_2h']]$gene_id)
}
{
intsc_146_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_146_up)
setdiff(intsc_146_up, res_list_up_sig[['res_2h']]$gene_id)
}
{
intsc_246_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_2h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_246_up)
setdiff(intsc_246_up, res_list_up_sig[['res_1h']]$gene_id)
}
length(intsc_246_up)
res_list_up_sig[['res_1h']]$gene_id
intsc_246_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_2h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_246_up)
setdiff(intsc_246_up, res_list_up_sig[['res_1h']]$gene_id)
length(setdiff(intsc_246_up, res_list_up_sig[['res_1h']]$gene_id))
# 2019/10/11
res_list <- list(res_1h = res_1h, res_2h = res_2h, res_4h = res_4h, res_6h = res_6h)
res_list_up <- lapply(res_list, res_subgroup, reg_dir ='up', alpha=1, reg_LFC=0)
res_list_up <- lapply(lapply(res_list_up, as_tibble, rownames = 'gene_id'),
dplyr::select, `gene_id`, `log2FoldChange`)
res_up_all <- Reduce(function(x, y) merge(x, y, by = 'gene_id',
all=TRUE, no.dups = T),
x = res_list_up)
res_list_up_sig <- lapply(res_list, res_subgroup, reg_dir ='up')
res_list_up_sig <- lapply(lapply(res_list_up_sig, as_tibble, rownames = 'gene_id'),
dplyr::select, `gene_id`, `log2FoldChange`)
# next get those subset
## 1246
intsc_1246_up <- Reduce(f = intersect, lapply(res_list_up_sig, `[[`, 'gene_id'))
length(intsc_1246_up)
## 124  not 6
{
intsc_124_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_2h', 'res_4h')], `[[`, 'gene_id'))
length(intsc_124_up)
setdiff(intsc_124_up, res_list_up_sig[['res_6h']]$gene_id)
}
## 126 not 4
{
intsc_126_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_2h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_126_up)
setdiff(intsc_126_up, res_list_up_sig[['res_4h']]$gene_id)
}
# 146 not 2
{
intsc_146_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_146_up)
setdiff(intsc_146_up, res_list_up_sig[['res_2h']]$gene_id)
}
## 246 not 1
{
intsc_246_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_2h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_246_up)
length(setdiff(intsc_246_up, res_list_up_sig[['res_1h']]$gene_id))
}
combn(c('1', '2', '4', '6'), m = 2)
combn(c('1', '2', '4', '6'), m = 2)[1]
combn(c('1', '2', '4', '6'), m = 2)
set_246 <- setdiff(intsc_246_up, res_list_up_sig[['res_1h']]$gene_id))
set_246 <- setdiff(intsc_246_up, res_list_up_sig[['res_1h']]$gene_id)
set_126 <- setdiff(intsc_126_up, res_list_up_sig[['res_4h']]$gene_id)
set_124 <- setdiff(intsc_124_up, res_list_up_sig[['res_6h']]$gene_id)
res_all[res_all$gene_id %in% intsc_1246_up]
res_all[res_all$gene_id %in% intsc_1246_up,]
colnames(res_all) <- c('gene_id', '1h', '2h', '4h', '6h')
res_all[res_all$gene_id %in% intsc_1246_up,]
res_all <- Reduce(function(x, y) merge(x, y, by = 'gene_id',
all=TRUE, no.dups = T),
x = res_list_all) %>% as_tibble()
colnames(res_all) <- c('gene_id', '1h', '2h', '4h', '6h')
res_all
dplyr::select, `gene_id`, `log2FoldChange`)
# next get those subset
## 1246
intsc_1246_up <- Reduce(f = intersect, lapply(res_list_up_sig, `[[`, 'gene_id'))
length(intsc_1246_up)
## 124  not 6
{
intsc_124_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_2h', 'res_4h')], `[[`, 'gene_id'))
length(intsc_124_up)
set_124 <- setdiff(intsc_124_up, res_list_up_sig[['res_6h']]$gene_id)
}
## 126 not 4
{
intsc_126_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_2h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_126_up)
set_126 <- setdiff(intsc_126_up, res_list_up_sig[['res_4h']]$gene_id)
}
# 146 not 2
{
intsc_146_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_1h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_146_up)
set_146 <- setdiff(intsc_146_up, res_list_up_sig[['res_2h']]$gene_id)
}
## 246 not 1
{
intsc_246_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_2h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_246_up)
set_246 <- setdiff(intsc_246_up, res_list_up_sig[['res_1h']]$gene_id)
}
write.xlsx(all, file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[1]], file = 'output/dontknowhowtoname.xlsx')
all[[1]]
all <- list(res_all[res_all$gene_id %in% intsc_1246_up,],
res_all[res_all$gene_id %in% set_124,],
res_all[res_all$gene_id %in% set_126,],
res_all[res_all$gene_id %in% set_146,],
res_all[res_all$gene_id %in% set_246,]
)
all[[1]]
write.xlsx(all, file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[1]], sheetName = 'intsc_1246_up' file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[1]], sheetName = 'intsc_1246_up', file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[1]], sheetName = 'intsc_1246_up', file = 'output/dontknowhowtoname.xlsx')
lapply(write.xlsx(all,
sheetName = c('intsc_1246_up', '124', '126', '146', '246'),
file = 'output/dontknowhowtoname.xlsx')
lapply(write.xlsx(all,
sheetName = c('intsc_1246_up', '124', '126', '146', '246'),
file = 'output/dontknowhowtoname.xlsx'))
lapply(write.xlsx(all,
sheetName = c('intsc_1246_up', '124', '126', '146', '246'),
file = 'output/dontknowhowtoname.xlsx'))
lapply(all, write.xlsx,
sheetName = c('intsc_1246_up', '124', '126', '146', '246'),
file = 'output/dontknowhowtoname.xlsx'))
lapply(all, write.xlsx,
sheetName = c('intsc_1246_up', '124', '126', '146', '246'),
file = 'output/dontknowhowtoname.xlsx')
lapply(all, write.xlsx,
sheetName = c('intsc_1246_up', '124', '126', '146', '246'),
file = 'output/dontknowhowtoname.xlsx')
lapply(all, write.xlsx,
sheetName = c('intsc_1246_up', '124', '126', '146', '246'),
file = 'output/dontknowhowtoname.xlsx',append = T)
write.xlsx(all[[2]],  sheetName = '124',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[['intsc_1246_up']],  sheetName = 'intsc_1246_up',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[set_124]],  sheetName = '124',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[set_126]],  sheetName = '126',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[set_146]],  sheetName = '146',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[set_246]],  sheetName = '246',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[['intsc_1246_up']],  sheetName = 'intsc_1246_up',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[['intsc_1246_up']],  sheetName = 'intsc_1246_up',
file = 'output/dontknowhowtoname.xlsx')
all[['intsc_1246_up']]
write.xlsx(all['intsc_1246_up'],  sheetName = 'intsc_1246_up',
file = 'output/dontknowhowtoname.xlsx')
all
write.xlsx(all[[1]],  sheetName = 'intsc_1246_up',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[2]],  sheetName = '124',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[3]],  sheetName = '126',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[4]],  sheetName = '146',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[5]],  sheetName = '246',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[1]],  sheetName = 'intsc_1246_up',
file = 'output/dontknowhowtoname.xlsx')
write.xlsx(all[[2]],  sheetName = '124',
file = 'output/dontknowhowtoname.xlsx', append = T)
write.xlsx(all[[3]],  sheetName = '126',
file = 'output/dontknowhowtoname.xlsx', append = T)
write.xlsx(all[[4]],  sheetName = '146',
file = 'output/dontknowhowtoname.xlsx', append = T)
write.xlsx(all[[5]],  sheetName = '246',
file = 'output/dontknowhowtoname.xlsx', append = T)
combn(c('1', '2', '4', '6'), m = 2)
{
intsc_246_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_2h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_246_up)
set_246 <- setdiff(intsc_246_up, res_list_up_sig[['res_1h']]$gene_id)
}
set_246 <- setdiff(intsc_246_up, res_list_up_sig[['res_1h']]$gene_id)
set_246
set_146
length(intsc_1246_up)
length(set_246)
length(set_146)
length(set_126)
length(set_124)
{
intsc_12_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_2h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_12_up)
set_12 <- setdiff(intsc_246_up, union(res_list_up_sig[['res_4h']]$gene_id,
res_list_up_sig[['res_6h']]$gene_id))
}
set_12
set_12 <- setdiff(intsc_12_up, union(res_list_up_sig[['res_4h']]$gene_id,
res_list_up_sig[['res_6h']]$gene_id))
set_12
{
intsc_12_up <- Reduce(f = intersect, lapply(res_list_up_sig[c('res_2h', 'res_4h', 'res_6h')], `[[`, 'gene_id'))
length(intsc_12_up)
set_12 <- setdiff(intsc_12_up, union(res_list_up_sig[['res_4h']]$gene_id,
res_list_up_sig[['res_6h']]$gene_id))
}
set_1
set_12
read.xlsx(file = 'data/venn_result Upregulated')
read.xlsx(file = 'data/venn_result Upregulated', sheetIndex = 1)
read.xlsx(file = 'data/venn_result Upregulated.xlsx', sheetIndex = 1)
upreg <- read.xlsx(file = 'data/venn_result Upregulated.xlsx', sheetIndex = 1)
View(upreg)
upreg %>% as_tibble() %>% fill(.direction = c("down"))
upreg %>% as_tibble() %>% fill(`Names`, .direction = c("down"))
upreg <- read.xlsx(file = 'data/venn_result Upregulated.xlsx', sheetIndex = 1, stringasfactor = F)
upreg %>% as_tibble() %>% fill(`Names`, .direction = c("down"))
upreg <- read.xlsx(file = 'data/venn_result Upregulated.xlsx', sheetIndex = 1, stringAsfactors = F)
upreg %>% as_tibble() %>% fill(`Names`, .direction = c("down"))
upreg <- read.xlsx(file = 'data/venn_result Upregulated.xlsx', sheetIndex = 1, stringsAsFactors = F)
upreg %>% as_tibble() %>% fill(`Names`, .direction = c("down"))
res_all[upreg[upreg$Names = '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up'],]
res_all[upreg[upreg$Names = '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]]
res_all[upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]]
res_all
res_all[res_all$gene_id %in% upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]
upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up'
res_all[res_all$gene_id %in% upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements,]
res_all$gene_id %in% upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements
res_all[res_all$gene_id %in% upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements,]
upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements
upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up'
upreg %>% as_tibble() %>% fill(`Names`, .direction = c("down"))
upreg <- upreg %>% as_tibble() %>% fill(`Names`, .direction = c("down"))
res_all[res_all$gene_id %in% upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements,]
upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements
res_all[res_all$gene_id %in% upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements,]
res_all[upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements,]
duplicated(res_all$gene_id)
all(!duplicated(res_all$gene_id))
res_all[res_all$gene_id %in% upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements,]
length(res_all[res_all$gene_id %in% upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements,])
nrow(res_all[res_all$gene_id %in% upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements,])
length(upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up'])
length(upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up'],)
length(upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',])
(upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',])
length(upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements)
nrow(res_all[res_all$gene_id %in% intsc_1246_up,])
res_all[res_all$gene_id %in% upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements,]
nrow(res_all[res_all$gene_id %in% upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements,])
res_all[res_all$gene_id %in% set_124,]
length(res_all[res_all$gene_id %in% set_124,])
nrow(res_all[res_all$gene_id %in% set_124,])
res_all[res_all$gene_id %in% intsc_1246_up,]
nrow(res_all[res_all$gene_id %in% intsc_1246_up,])
res_all[res_all$gene_id %in% upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements,]
View(upreg)
upreg[upreg$Names == '1 Hour Up 2 Hours Up 4 Hours Up 6 Hours Up',]$elements == intsc_1246_up
factor(upreg$Names)
llevels(upreg$Names)
levels(upreg$Names)
levels(factor(upreg$Names))
combo <- levels(factor(upreg$Names))
up_comb <- list()
for(i in 1:length(combo)){
up_comb[[i]] <- res_all[res_all$gene_id %in% upreg[upreg$Names == comb[i],]$elements,]
}
combo <- levels(factor(upreg$Names))
up_comb <- list()
for(i in 1:length(combo)){
up_comb[[i]] <- res_all[res_all$gene_id %in% upreg[upreg$Names == combo[i],]$elements,]
}
up_comb
nrow(up_comb[[1]])
nrow(up_comb[[2]])
up_comb[[1]]
combo
combo <- levels(factor(upreg$Names, ordered = T))
combo
combo <- levels(factor(upreg$Names, ordered = T))
factor(upreg$Names, ordered = T)
combo <- levels(factor(upreg$Names))
combo <- levels(factor(upreg$Names, levels = unique(upreg$Names)))
combo
for(i in 1:length(combo)){
up_comb[[i]] <- res_all[res_all$gene_id %in% upreg[upreg$Names == combo[i],]$elements,]
}
nrow(up_comb[[1]])
for(i in 1:length(combo)){
write.xlsx(up_comb,  sheetName = combo[[i]],
file = 'output/up_comb.xlsx'))
}
for(i in 1:length(combo)){
write.xlsx(up_comb,  sheetName = combo[[i]],
file = 'output/up_comb.xlsx')
}
for(i in 1:length(combo)){
write.xlsx(up_comb[[i]],  sheetName = combo[[i]],
file = 'output/up_comb.xlsx')
}
for(i in 1:length(combo)){
write.xlsx(up_comb[[i]],  sheetName = combo[[i]],
file = 'output/up_comb.xlsx', append = T)
}
combo
for(i in 1:length(combo)){
write.xlsx(up_comb[[i]],  sheetName = combo[[i]],
file = 'output/up_comb.xlsx', append = T)
}
{
write.xlsx(up_comb[[1]],  sheetName = combo[[1]],
file = 'output/up_comb.xlsx')
for(i in 2:length(combo)){
write.xlsx(up_comb[[i]],  sheetName = combo[[i]],
file = 'output/up_comb.xlsx', append = T)
}
}
combo
for(i in 1:length(combo)){
write.xlsx(up_comb[[i]],  sheetName = sub('Hours', '', combo)[[i]],
file = 'output/up_comb.xlsx', append = T)
}
for(i in 1:length(combo)){
write.xlsx(up_comb[[i]],  sheetName = sub('Hours', '', combo)[[i]],  # the sheetname is short
file = 'output/up_comb.xlsx', append = T)
}
downreg <- read.xlsx(file = 'Venn_Downregulated.xlsx', sheetIndex = 1, stringsAsFactors = F)
downreg <- downreg %>% as_tibble() %>% fill(`Names`, .direction = c("down"))
combo_down <- levels(factor(upreg$Names, levels = unique(upreg$Names)))
downreg <- read.xlsx(file = 'Venn_Downregulated.xlsx', sheetIndex = 1, stringsAsFactors = F)
downreg <- read.xlsx(file = 'data/Venn_Downregulated.xlsx', sheetIndex = 1, stringsAsFactors = F)
downreg <- downreg %>% as_tibble() %>% fill(`Names`, .direction = c("down"))
combo_down <- levels(factor(upreg$Names, levels = unique(upreg$Names)))
down_comb <- list()
for(i in 1:length(combo_down)){
down_comb[[i]] <- res_all[res_all$gene_id %in% downreg[downreg$Names == combo_down[i],]$elements,]
}
#
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('Hours', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
down_comb <- list()
for(i in 1:length(combo_down)){
down_comb[[i]] <- res_all[res_all$gene_id %in% downreg[downreg$Names == combo_down[i],]$elements,]
}
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('Hours', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
length(combo_down)
combo_down
downreg <- read.xlsx(file = 'data/Venn_Downregulated.xlsx', sheetIndex = 1, stringsAsFactors = F)
downreg <- downreg %>% as_tibble() %>% fill(`Names`, .direction = c("down"))
combo_down <- levels(factor(downreg$Names, levels = unique(upreg$Names)))
down_comb <- list()
for(i in 1:length(combo_down)){
down_comb[[i]] <- res_all[res_all$gene_id %in% downreg[downreg$Names == combo_down[i],]$elements,]
}
#
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('Hours', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
down_comb <- list()
for(i in 1:length(combo_down)){
down_comb[[i]] <- res_all[res_all$gene_id %in% downreg[downreg$Names == combo_down[i],]$elements,]
}
#
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('Hours', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
down_comb[[i]]
down_comb[[1]]
downreg[downreg$Names == combo_down[i],]$elements
downreg[downreg$Names == combo_down[1],]$elements
downreg$Names
combo_down[i]
downreg <- read.xlsx(file = 'data/Venn_Downregulated.xlsx', sheetIndex = 1, stringsAsFactors = F)
downreg <- downreg %>% as_tibble() %>% fill(`Names`, .direction = c("down"))
combo_down <- levels(factor(downreg$Names, levels = unique(downreg$Names)))
down_comb <- list()
for(i in 1:length(combo_down)){
down_comb[[i]] <- res_all[res_all$gene_id %in% downreg[downreg$Names == combo_down[i],]$elements,]
}
#
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('Hours', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
downreg <- read.xlsx(file = 'data/Venn_Downregulated.xlsx', sheetIndex = 1, stringsAsFactors = F)
downreg <- downreg %>% as_tibble() %>% fill(`Names`, .direction = c("down"))
combo_down <- levels(factor(downreg$Names, levels = unique(downreg$Names)))
down_comb <- list()
for(i in 1:length(combo_down)){
down_comb[[i]] <- res_all[res_all$gene_id %in% downreg[downreg$Names == combo_down[i],]$elements,]
}
#
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('Hours', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
sub('Hours', '', combo_down)
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('hours', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
sub('hours', '', combo_down)
write.xlsx(down_comb[[i]],  sheetName = sub('hour', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('hour', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('hour', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
sub('hour', '', combo_down)
#
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('hour.*', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('hour.*', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
sub('hour.*', '', combo_down)
#
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = sub('hour[s]*', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
sub('hour[s]*', '', combo_down)
sheetName = gsub('hour[s]*', '', combo_down)
gsub('hour[s]*', '', combo_down)
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = gsub('hour[s]*', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
for(i in 1:length(combo_down)){
write.xlsx(down_comb[[i]],  sheetName = gsub('hour[s]*', '', combo_down)[[i]],  # the sheetname is short
file = 'output/down_comb.xlsx', append = T)
}
